url:
  pptxhandler/morph:
    pattern: /$YAMLURL/output.pptx
    handler: PPTXHandler
    kwargs:
      version: 2
      source: $YAMLPATH/template.pptx
      data:
        sales:
          url: '$YAMLPATH/sales.csv'
          transform: data.set_index('month')
        max_sales: {function: sales.values.max()}
      # Copy slides, update data and apply morph transition
      rules:
        - copy-slide: sales
          Month:
              text: 'copy.key'
          '!!Visitors Value':
              text: copy.val['visitors']
          '!!Leads Value':
              text: copy.val['leads']
          '!!Cart Value':
              text: copy.val['cart']
          '!!Visitors Bar':
              width: (copy.val['visitors'] / max_sales) * 3
          '!!Leads Bar':
              width: (copy.val['leads'] / max_sales) * 3
          '!!Cart Bar':
              width: (copy.val['cart'] / max_sales) * 3
          transition:            # All slides have morph transition for a duration of 1 second
            type: f'morph'
            duration: 1
